# DVH-IMS V1.5 — Phase 2 Planning: Assignments

**Status:** PROPOSED — NOT APPROVED
**Date:** 2026-02-07
**Authority:** Delroy

---

## 1. Phase Objective

Provide operational visibility into case-to-worker assignments and visit scheduling for Bouwsubsidie dossiers. Enable managerial oversight of workload distribution without altering decision authority or workflow logic.

---

## 2. Definition of "Assignment" in DVH-IMS Context

Two distinct assignment concepts exist in DVH-IMS:

### A) Case Assignment (Bouwsubsidie)

- The link between an active dossier and the worker currently responsible for progressing it
- Currently implicit: the system routes cases to role-based queues (Control Queue, My Visits) but does NOT persist a named worker-to-case relationship
- V1.5 Phase 2 aims to make this explicit and persistent

### B) Visit Schedule (Bouwsubsidie)

- The record of planned and completed field visits (social assessment, technical inspection)
- Currently implicit: workers pick cases from their queue but no scheduled date/time is persisted
- V1.5 Phase 2 aims to make visit scheduling durable

### Distinction from existing `assignment_record` table

The existing `assignment_record` table is a Woningregistratie concept (housing unit allocation to a household). It is NOT related to case-to-worker operational assignments. These are separate domains per the service separation protocol.

---

## 3. Assignment Model (Conceptual)

### Case Assignment is person-based

- A specific user (worker) is assigned to a specific dossier
- Assignment is role-contextual: a social_field_worker is assigned for social review; a technical_inspector for technical review
- Multiple concurrent assignments per dossier are possible (parallel review steps)
- Assignment does not confer decision authority — it indicates operational responsibility

### Visit Schedule is person-based and time-bound

- A visit links a worker, a dossier, a date/time, and a visit type (social / technical)
- Visits have a simple lifecycle: scheduled, completed, cancelled
- No automatic workflow triggers from visit status changes

---

## 4. Assignment Lifecycle (Conceptual)

### Case Assignment lifecycle

1. **UNASSIGNED** — Case is in a role queue but no specific worker claimed/was assigned
2. **ASSIGNED** — A specific worker is linked to the case for a given review step
3. **REASSIGNED** — Case transferred to a different worker (previous assignment closed, new one created)
4. **COMPLETED** — Worker completed their review step; assignment is closed

### Visit Schedule lifecycle

1. **SCHEDULED** — Visit planned with date, time, location
2. **COMPLETED** — Visit took place
3. **CANCELLED** — Visit cancelled (reason recorded)

---

## 5. Role Interaction Matrix (Conceptual)

| Role | Can Assign | Can Reassign | Can View Own | Can View All | Can Schedule Visit |
|------|-----------|-------------|-------------|-------------|-------------------|
| system_admin | Yes (all) | Yes (all) | Yes | Yes | Yes |
| project_leader | Yes (all) | Yes (all) | Yes | Yes | Yes |
| admin_staff | Yes (own district) | Yes (own district) | Yes | District | Yes |
| frontdesk_bouwsubsidie | No | No | Yes | No | No |
| social_field_worker | Self-assign only | No | Yes | No | No |
| technical_inspector | Self-assign only | No | Yes | No | No |
| director | No | No | No | Yes (read-only) | No |
| ministerial_advisor | No | No | No | Yes (read-only) | No |
| minister | No | No | No | Yes (read-only) | No |
| audit | No | No | No | Yes (read-only) | No |

---

## 6. Relationship to Existing Dossier States

- Assignments exist alongside dossier states but do NOT drive state transitions
- A case in `in_social_review` may be unassigned (in queue) or assigned (to a specific worker)
- State changes remain governed by the existing backend transition engine
- Assignment changes are operational metadata, not workflow events

---

## 7. Scope Boundaries

### In Scope (Phase 2)

- Conceptual definition of case assignment and visit scheduling
- Role-based assignment and visibility rules
- Assignment and visit lifecycle definitions
- Governance and audit requirements
- Relationship to existing operational views (Control Queue, My Visits, Schedule Visits)

### Explicitly Out of Scope

- Decision-making authority changes
- New dossier states
- Workflow automation triggered by assignments
- Performance metrics, KPIs, or workload analytics
- Time tracking
- Notifications or escalations
- Schema or RLS changes
- Any implementation detail (UI, data model, API)
- Woningregistratie case assignments (separate service domain)

---

## 8. Governance and Audit Considerations

- **Traceability:** Every assignment creation, reassignment, and completion must be logged to `audit_event` with actor, timestamp, dossier_id, assigned_worker, and action type
- **Separation of concerns:** Assignment (operational control) must never be conflated with decision authority. Assigning a worker does not grant approval/rejection power beyond their existing role
- **Accountability:** Reassignment must preserve the full history — who was previously assigned, who reassigned, and why
- **Immutability:** Assignment history is append-only; completed or cancelled assignments cannot be deleted or modified

---

## 9. Dependencies and Risks

### Dependencies

- V1.4 Control Queue, My Visits, and Schedule Visits interfaces (implemented and operational)
- V1.3 backend transition engine and role model (11 active roles)
- Existing `subsidy_case` table and status model

### Risks

- **Scope creep:** Assignments could easily expand into workload balancing, auto-routing, or performance tracking. Strict boundaries required.
- **Implicit vs explicit tension:** The current system works with implicit role-based queues. Introducing explicit assignments may create confusion if both models coexist without clear UX distinction.
- **District boundary enforcement:** If admin_staff can assign within their district, the system must reliably enforce district scoping for assignment operations.
- **Data volume:** Visit scheduling persistence introduces new data that grows linearly with case volume. No immediate concern but noted for Scale Pack awareness.

---

## 10. Open Questions and Decision Points

| ID | Question | Impact |
|----|----------|--------|
| Q1 | Should case assignment be mandatory (every case must have an assigned worker) or optional (cases can remain in role queues)? | Assignment model design |
| Q2 | Should visit scheduling support recurring visits or single visits only? | Data model complexity |
| Q3 | Should reassignment require a reason/justification? | Audit granularity |
| Q4 | Should oversight roles (director, minister) see assignment data inline on dossier detail pages or only in a dedicated assignments view? | UI integration scope |
| Q5 | Should the existing Schedule Visits page (V1.4) be enhanced in-place or should a new persistent scheduling interface be created? | Implementation approach |
| Q6 | Is there a maximum number of concurrent assignments per worker that should be enforced or tracked? | Workload management |

---

## 11. Execution Gate

- Phase 2 planning is complete
- No Phase 2 implementation has started
- Implementation requires separate authorization

---

*No code, schema, RLS, or UI changes. Planning document only.*
